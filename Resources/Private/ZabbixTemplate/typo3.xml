<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>4.4</version>
    <date>2019-10-19T01:28:17Z</date>
    <groups>
        <group>
            <name>Templates/Applications</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template TYPO3</template>
            <name>Template TYPO3</name>
            <groups>
                <group>
                    <name>Templates/Applications</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>TYPO3</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>TYPO3 Failed Logins</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_FailedLogins</key>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>GetLogResults</value>
                        </query_field>
                        <query_field>
                            <name>filter</name>
                            <value>FailedLogins</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>TYPO3 Application Context</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_GetApplicationContext</key>
                    <delay>5m</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>GetApplicationContext</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                    <verify_peer>YES</verify_peer>
                    <triggers>
                        <trigger>
                            <expression>{str(Production)}=0</expression>
                            <name>TYPO3 Application Context is not Production</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TYPO3 Database Version</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_GetDatabaseVersion</key>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value[0]</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>GetDatabaseVersion</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>TYPO3 Insecure Extensions</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_GetInsecureExtensionList</key>
                    <delay>1d</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>GetInsecureExtensionList</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                    <verify_peer>YES</verify_peer>
                    <triggers>
                        <trigger>
                            <expression>{str(false)}=0</expression>
                            <name>TYPO3 Insecure Extensions detected</name>
                            <priority>HIGH</priority>
                            <type>MULTIPLE</type>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TYPO3 Last Extension List Update</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_GetLastExtensionListUpdate</key>
                    <delay>1d</delay>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>GetLastExtensionListUpdate</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{fuzzytime(172800)}=0</expression>
                            <name>TYPO3 Extension List Update is more than 2 days overdue</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TYPO3 Last Scheduler Run</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_GetLastSchedulerRun</key>
                    <delay>1d</delay>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>GetLastSchedulerRun</value>
                        </query_field>
                    </query_fields>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{fuzzytime(172800)}=0</expression>
                            <name>TYPO3 Scheduler is more than 2 days overdue</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TYPO3 Outdated Extension</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_GetOutdatedExtensionList</key>
                    <delay>1d</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>GetOutdatedExtensionList</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                    <verify_peer>YES</verify_peer>
                    <triggers>
                        <trigger>
                            <expression>{str(false)}=0</expression>
                            <name>TYPO3 Outdated Extensions detected</name>
                            <priority>INFO</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>PHP Version</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_GetPHPVersion</key>
                    <delay>30s</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <timeout>5s</timeout>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>GetPHPVersion</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                    <verify_peer>YES</verify_peer>
                </item>
                <item>
                    <name>TYPO3 Total Log Files Size (KB)</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_GetTotalLogFilesSize</key>
                    <delay>1h</delay>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>GetTotalLogFilesSize</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                    <verify_peer>YES</verify_peer>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;10000</expression>
                            <name>TYPO3 log files size is too big</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TYPO3 Version</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_GetTYPO3Version</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>GetTYPO3Version</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>TYPO3 Zabbix client log file</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_GetZabbixLogFileSize</key>
                    <delay>5m</delay>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>GetZabbixLogFileSize</value>
                        </query_field>
                    </query_fields>
                    <request_method>POST</request_method>
                    <verify_peer>YES</verify_peer>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0</expression>
                            <name>TYPO3 Zabbix log file increased</name>
                            <priority>HIGH</priority>
                            <description>An indicator of unauthorized access to the interface</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TYPO3 Forbidden users</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_HasForbiddenUsers</key>
                    <delay>1d</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>HasForbiddenUsers</value>
                        </query_field>
                        <query_field>
                            <name>usernames</name>
                            <value>admin</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                    <verify_peer>YES</verify_peer>
                    <triggers>
                        <trigger>
                            <expression>{str(false)}=0</expression>
                            <name>TYPO3 Has forbidden user</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TYPO3 Has remaining updates</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_HasRemainingUpdates</key>
                    <delay>8h</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>HasRemainingUpdates</value>
                        </query_field>
                    </query_fields>
                    <request_method>POST</request_method>
                    <verify_peer>YES</verify_peer>
                    <triggers>
                        <trigger>
                            <expression>{str(false)}=0</expression>
                            <name>TYPO3 Has remaining updates</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TYPO3 Security Update available</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_HasSecurityUpdate</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>HasSecurityUpdate</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{str(true)}=1</expression>
                            <name>TYPO3 Security Update available</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TYPO3 Strict Syntax Check</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_HasStrictSyntaxEnabled</key>
                    <delay>1d</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>HasStrictSyntaxEnabled</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                    <verify_peer>YES</verify_peer>
                </item>
                <item>
                    <name>TYPO3 Update available</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_HasUpdate</key>
                    <delay>1h</delay>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>HasUpdate</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{str(true)}=1</expression>
                            <name>TYPO3 Update available</name>
                            <priority>INFO</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>TYPO3 Other Exceptions</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_OtherExceptions</key>
                    <delay>30s</delay>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>GetLogResults</value>
                        </query_field>
                        <query_field>
                            <name>filter</name>
                            <value>OtherExceptions</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>TYPO3 PageNotFoundExceptions</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_PageNotFoundException</key>
                    <delay>30s</delay>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>GetLogResults</value>
                        </query_field>
                        <query_field>
                            <name>filter</name>
                            <value>PageNotFoundException</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>TYPO3 ServiceUnavailableExceptions</name>
                    <type>HTTP_AGENT</type>
                    <key>typo3_ServiceUnavailableException</key>
                    <delay>30s</delay>
                    <applications>
                        <application>
                            <name>TYPO3</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.value</params>
                        </step>
                    </preprocessing>
                    <url>https://{HOST.HOST}/zabbixclient/</url>
                    <query_fields>
                        <query_field>
                            <name>key</name>
                            <value>{$TYPO3_CLIENT_KEY}</value>
                        </query_field>
                        <query_field>
                            <name>operation</name>
                            <value>GetLogResults</value>
                        </query_field>
                        <query_field>
                            <name>filter</name>
                            <value>ServiceUnavailableException</value>
                        </query_field>
                    </query_fields>
                    <follow_redirects>NO</follow_redirects>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0</expression>
                            <name>TYPO3 ServiceUnavailableExceptions increased</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
        </template>
    </templates>
    <graphs>
        <graph>
            <name>Errors</name>
            <type>STACKED</type>
            <graph_items>
                <graph_item>
                    <color>4527A0</color>
                    <item>
                        <host>Template TYPO3</host>
                        <key>typo3_ServiceUnavailableException</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>8E24AA</color>
                    <item>
                        <host>Template TYPO3</host>
                        <key>typo3_PageNotFoundException</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>C62828</color>
                    <item>
                        <host>Template TYPO3</host>
                        <key>typo3_OtherExceptions</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
</zabbix_export>
